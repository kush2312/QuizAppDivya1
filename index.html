<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz App</title>

  <style>
    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 16px;
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .quiz-container {
      background: #fff;
      width: 100%;
      max-width: 420px;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .counter {
      text-align: center;
      font-size: 14px;
      color: #555;
      margin-bottom: 8px;
    }

    h2 {
      font-size: 18px;
      text-align: center;
      margin-bottom: 16px;
    }

    .option {
      margin-bottom: 12px;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .option:hover {
      background: #f1f5ff;
    }

    .option input {
      transform: scale(1.2);
    }

    .buttons {
      display: flex;
      gap: 10px;
      margin-top: 16px;
    }

    button {
      flex: 1;
      padding: 12px;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .btn-prev {
      background: #9e9e9e;
      color: white;
    }

    .btn-submit {
      background: #1976d2;
      color: white;
    }

    .btn-prev:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .error {
      color: #d32f2f;
      text-align: center;
      margin-top: 12px;
    }

    .success {
      color: #388e3c;
      text-align: center;
      margin-top: 12px;
    }

    .loading {
      text-align: center;
      font-size: 16px;
    }
  </style>
</head>

<body>

<div class="quiz-container">
  <div id="loading" class="loading">Loading quizâ€¦</div>

  <div id="quiz" style="display:none;">
    <div class="counter" id="counter"></div>
    <h2 id="question"></h2>

    <div id="options"></div>

    <div class="buttons">
      <button class="btn-prev" id="prevBtn" onclick="goPrevious()">â¬… Previous</button>
      <button class="btn-submit" onclick="submitAnswer()">Submit</button>
    </div>

    <div id="message"></div>
  </div>
</div>

<script>
  let quizData = [];
  let currentIndex = 0;
  const selectedAnswers = {};
  const shuffledOptionsMap = {}; // preserve shuffle per question

  fetch("quiz_data.json")
    .then(res => res.json())
    .then(data => {
      quizData = data;
      document.getElementById("loading").style.display = "none";
      document.getElementById("quiz").style.display = "block";
      loadQuestion();
    });

  function shuffle(array) {
    return [...array].sort(() => Math.random() - 0.5);
  }

  function loadQuestion() {
    const q = quizData[currentIndex];

    document.getElementById("counter").innerText =
      `Question ${currentIndex + 1} of ${quizData.length}`;

    document.getElementById("question").innerText = q.question;

    // Shuffle options once per question
    if (!shuffledOptionsMap[currentIndex]) {
      shuffledOptionsMap[currentIndex] = shuffle(q.options);
    }

    const options = shuffledOptionsMap[currentIndex];
    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";

    options.forEach(option => {
      const checked = selectedAnswers[currentIndex] === option ? "checked" : "";

      const div = document.createElement("div");
      div.className = "option";
      div.innerHTML = `
        <input type="radio" name="answer" value="${option}" ${checked}/>
        <span>${option}</span>
      `;

      // Make entire row clickable
      div.onclick = () => {
        div.querySelector("input").checked = true;
      };

      optionsDiv.appendChild(div);
    });

    document.getElementById("message").innerHTML = "";
    document.getElementById("prevBtn").disabled = currentIndex === 0;
  }

  function submitAnswer() {
    const selected = document.querySelector('input[name="answer"]:checked');

    if (!selected) {
      showMessage("Please select an option", "error");
      return;
    }

    const answer = selected.value;
    selectedAnswers[currentIndex] = answer;

    if (answer === quizData[currentIndex].correct) {
      showMessage("Correct âœ…", "success");

      setTimeout(() => {
        currentIndex++;
        if (currentIndex < quizData.length) {
          loadQuestion();
        } else {
          document.querySelector(".quiz-container").innerHTML =
            "<h2>ðŸŽ‰ Quiz Completed!</h2>";
        }
      }, 500);
    } else {
      showMessage("âŒ Wrong answer. Try again.", "error");
    }
  }

  function goPrevious() {
    if (currentIndex > 0) {
      currentIndex--;
      loadQuestion();
    }
  }

  function showMessage(text, type) {
    document.getElementById("message").innerHTML =
      `<div class="${type}">${text}</div>`;
  }
</script>

</body>
</html>
